[INIT] DNS forzado a los servidores de Google para evitar problemas de red.
[INIT] Helmet cargado correctamente
[INIT] Rate limit cargado correctamente
[CORS] Lista blanca final: [
  'http://localhost:3000',
  'https://tudominio.com',
  'http://localhost:10000',
  'http://127.0.0.1:3000',
  'http://127.0.0.1:10000',
  'https://agentes-49dr.onrender.com',
  'https://agentes-frontend.onrender.com'
]
[DB] Intentando conectar a MongoDB Atlas...
[DB] Conexión nativa a MongoDB Atlas establecida.
[SERVER] Conexión a base de datos establecida.
[SERVER] GridFS inicializado correctamente.
(node:5456) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
[Mongoose] Conectado a Atlas
[SERVER] Base de datos lista, iniciando servidor...
[SERVER] Servidor corriendo en el puerto 3000
[SERVER] Entorno: development
[SERVER] URL: http://localhost:3000
[Socket.io] WebSocket activo
[API DEBUG] Incoming request {
  method: 'POST',
  url: '/api/auth/login',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'content-length': '51',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'cache-control': 'no-cache',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: undefined
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/ranking?all=1&limit=50',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: undefined
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: undefined
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro automático por mes actual: 2025-12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?agente=Lisbeth%20Cortez',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-12-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 18
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro automático por mes actual: 2025-12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-12-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 18
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro automático por mes actual: 2025-12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?allData=true&noFilter=true&skipDate=true&limit=99999&page=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/customers?allData=true&noFilter=true&skipDate=true&limit=99999&page=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[RANKING] Parámetros recibidos: {
  fechaInicio: undefined,
  fechaFin: undefined,
  all: '1',
  limitParam: '50',
  debug: undefined,
  skipDate: undefined,
  agente: undefined,
  field: 'createdAt'
}
[RANGOS] Efectivo { startDate: '2025-12-01', endDate: '2025-12-02' }
[RANKING] Pipeline de agregación: [
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$createdAt"
              },
              "date"
            ]
          },
          "$createdAt",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "string"
                ]
              },
              {
                "$dateFromString": {
                  "dateString": {
                    "$toString": "$createdAt"
                  },
                  "timezone": "-06:00"
                }
              },
              null
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$dia_venta"
              },
              "date"
            ]
          },
          "$dia_venta",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$dateFromString": {
                      "dateString": "$$s",
                      "format": "%Y-%m-%d",
                      "timezone": "-06:00"
                    }
                  },
                  {
                    "$cond": [
                      {
                        "$regexMatch": {
                          "input": "$$s",
                          "regex": {}
                        }
                      },
                      {
                        "$let": {
                          "vars": {
                            "parts": {
                              "$split": [
                                "$$s",
                                "/"
                              ]
                            }
                          },
                          "in": {
                            "$dateFromParts": {
                              "year": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    2
                                  ]
                                }
                              },
                              "month": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    1
                                  ]
                                }
                              },
                              "day": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    0
                                  ]
                                }
                              }
                            }
                          }
                        }
                      },
                      {
                        "$cond": [
                          {
                            "$regexMatch": {
                              "input": "$$s",
                              "regex": {}
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$let": {
                      "vars": {
                        "parts": {
                          "$split": [
                            "$$s",
                            "/"
                          ]
                        }
                      },
                      "in": {
                        "$dateFromParts": {
                          "year": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                2
                              ]
                            }
                          },
                          "month": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                1
                              ]
                            }
                          },
                          "day": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                0
                              ]
                            }
                          }
                        }
                      }
                    }
                  },
                  null
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "date"
                ]
              },
              "$createdAt",
              {
                "$cond": [
                  {
                    "$eq": [
                      {
                        "$type": "$createdAt"
                      },
                      "string"
                    ]
                  },
                  {
                    "$dateFromString": {
                      "dateString": {
                        "$toString": "$createdAt"
                      },
                      "timezone": "-06:00"
                    }
                  },
                  null
                ]
              }
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "_diaParsed": {
        "$ne": null
      },
      "$expr": {
        "$and": [
          {
            "$gte": [
              "$_diaParsed",
              "2025-12-01T06:00:00.000Z"
            ]
          },
          {
            "$lt": [
              "$_diaParsed",
              "2026-01-01T06:00:00.000Z"
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$regex": {}
          }
        },
        {
          "agente": {
            "$regex": {}
          }
        }
      ]
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$exists": true,
            "$ne": ""
          }
        },
        {
          "agente": {
            "$exists": true,
            "$ne": ""
          }
        }
      ],
      "excluirDeReporte": {
        "$ne": true
      }
    }
  },
  {
    "$addFields": {
      "_statusStr": {
        "$toUpper": {
          "$trim": {
            "input": {
              "$ifNull": [
                "$status",
                ""
              ]
            }
          }
        }
      },
      "_agenteFuente": {
        "$ifNull": [
          "$agenteNombre",
          "$agente"
        ]
      }
    }
  },
  {
    "$addFields": {
      "_statusNorm": {
        "$cond": [
          {
            "$regexMatch": {
              "input": "$_statusStr",
              "regex": {}
            }
          },
          "CANCEL",
          {
            "$cond": [
              {
                "$regexMatch": {
                  "input": "$_statusStr",
                  "regex": {}
                }
              },
              "PENDING",
              "$_statusStr"
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "isCancel": {
        "$eq": [
          "$_statusNorm",
          "CANCEL"
        ]
      },
      "puntajeEfectivo": {
        "$cond": [
          {
            "$eq": [
              "$_statusNorm",
              "CANCEL"
            ]
          },
          0,
          {
            "$toDouble": {
              "$ifNull": [
                "$puntaje",
                0
              ]
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_nameNoSpaces": {
        "$replaceAll": {
          "input": {
            "$replaceAll": {
              "input": {
                "$replaceAll": {
                  "input": "$_agenteFuente",
                  "find": "_",
                  "replacement": ""
                }
              },
              "find": ".",
              "replacement": ""
            }
          },
          "find": " ",
          "replacement": ""
        }
      },
      "_nameNormLower": {
        "$toLower": {
          "$replaceAll": {
            "input": {
              "$replaceAll": {
                "input": {
                  "$replaceAll": {
                    "input": "$_agenteFuente",
                    "find": "_",
                    "replacement": ""
                  }
                },
                "find": ".",
                "replacement": ""
              }
            },
            "find": " ",
            "replacement": ""
          }
        }
      }
    }
  },
  {
    "$group": {
      "_id": "$_nameNormLower",
      "ventas": {
        "$sum": {
          "$cond": [
            "$isCancel",
            0,
            1
          ]
        }
      },
      "sumPuntaje": {
        "$sum": "$puntajeEfectivo"
      },
      "avgPuntaje": {
        "$avg": "$puntaje"
      },
      "anyName": {
        "$first": "$_nameNoSpaces"
      }
    }
  },
  {
    "$project": {
      "_id": 0,
      "nombre": "$anyName",
      "ventas": 1,
      "sumPuntaje": "$sumPuntaje",
      "avgPuntaje": "$avgPuntaje",
      "puntos": "$sumPuntaje"
    }
  },
  {
    "$sort": {
      "puntos": -1,
      "ventas": -1,
      "nombre": 1
    }
  },
  {
    "$limit": 50
  }
]
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-12-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 18
Solicitud recibida en /api/customers
Parámetros - Página: 1, Límite: 500, Saltar: 0
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro automático por mes actual: 2025-12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
Colecciones disponibles en crmagente: [
  'employeesOfMonth',
  'noteFiles.chunks',
  'costumers_Fernanda_Castillo',
  'Facturacion',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'bulk_status_audit',
  'employees_of_month',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'employeeofmonths',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'leads',
  'user_collections',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'CostumersExcluidos',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'users',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'noteFiles.files',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'mediafiles',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez',
  'Lineas',
  'Vcomments'
]
Intentando acceder a la colección (default): costumers
[INFO] Using mapped collection for current user: costumers_Lisbeth_Cortez
[DEBUG] Usuario autenticado - ID: 68af5651c61c405e2bb7b0e6, Rol: "Agente", Rol original: "Agente", forceAll=false
[DEBUG] ¿Es supervisor? role === 'supervisor': false, includes: false
[DEBUG] Rol no privilegiado: aplicando filtro propio por ID en campos: [
  'agenteId',   'agente_id',
  'idAgente',   'agentId',
  'createdBy',  'creadoPor',
  'creado_por', 'ownerId',
  'assignedId'
]
[DEBUG] Filtro aplicado: {
  "$or": [
    {
      "agenteId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "agente_id": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "idAgente": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "agentId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "createdBy": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "creadoPor": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "creado_por": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "ownerId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "assignedId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    }
  ]
}
[DEBUG] req.query recibido en /api/customers: {"allData":"true","noFilter":"true","skipDate":"true","limit":"99999","page":"1"}
[DEBUG] Query final a usar en MongoDB: {"$or":[{"agenteId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"agente_id":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"idAgente":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"agentId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"createdBy":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"creadoPor":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"creado_por":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"ownerId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"assignedId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}}]}
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-12-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 18
Total de documentos en la colección: 44
[DEBUG] Orden aplicándose: { creadoEn: -1 }
Documentos encontrados: 44
Primer documento de ejemplo: {
  "_id": "692f250915275dfe49d5521d",
  "nombre_cliente": "MAUDA  HERNANDEZ",
  "telefono": "6319189849",
  "telefono_alterno": "",
  "direccion": "85 N Mickley Ave Indianapolis IN 46224",
  "tipo_servicio": "XFINITY",
  "producto": "",
  "servicios": "xfinity-500-plus",
  "servicios_texto": "XFINITY 500MBPS+",
  "sistema": "na",
  "sistema_texto": "N/A",
  "mercado": "ICON",
  "riesgo": "N/A",
  "autopago": true,
  "dia_venta": "2025-12-02",
  "team": "ROBERTO",
  "supervisor": "ROBERTO",
  "agente": "Lisbeth Cortez",
  "dia_instalacion": "2025-12-04",
  "puntaje": 0.75,
  "zip": "46224",
  "creadoEn": "2025-12-02T17:42:33.232Z",
  "actualizadoEn": "2025-12-02T17:42:33.232Z",
  "producto_contratado": "XFINITY 500MBPS+",
  "fecha_contratacion": "2025-12-02",
  "equipo": "ROBERTO",
  "fecha_creacion": "2025-12-02T17:42:33.232Z",
  "status": "pendiente",
  "comentario": "ADQUIRIR SERVICIOS",
  "motivo_llamada": "ADQUIRIR SERVICIOS",
  "numero_cuenta": "2512024239687129",
  "telefono_principal": "6319189849",
  "fuente": "WEB",
  "asignadoA": null,
  "notas": [],
  "agenteNombre": "Lisbeth Cortez",
  "agenteId": "68af5651c61c405e2bb7b0e6",
  "createdBy": "Lisbeth Cortez",
  "historial": [
    {
      "accion": "CREADO",
      "fecha": "2025-12-02T17:42:33.232Z",
      "usuario": "Lisbeth Cortez",
      "detalles": "Lead creado a través del formulario web",
      "agenteId": "68af5651c61c405e2bb7b0e6"
    }
  ]
}
Enviando respuesta con 44 clientes
[USERS UPDATE ROLE] after getDb, db present? true
[RANKING] Colecciones candidatas para ALL: [
  'costumers_Fernanda_Castillo',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez'
]
[RANKING] Datos encontrados en colección: costumers_Fernanda_Castillo -> 0
[RANKING] Datos encontrados en colección: costumers_Jonathan_Morales -> 0
[RANKING] Datos encontrados en colección: costumers_Lucia_Ferman -> 0
[RANKING] Datos encontrados en colección: costumers_Carlos_Grande -> 0
[RANKING] Datos encontrados en colección: costumers_68ba19 -> 0
[RANKING] Datos encontrados en colección: costumers_Nelson_Ceren -> 0
[RANKING] Datos encontrados en colección: costumers_Luis_Chavarria -> 0
[RANKING] Datos encontrados en colección: costumers_68af41d0c61c405e2bb7b0c8 -> 0
[RANKING] Datos encontrados en colección: costumers_Anderson_Guzman -> 0
[RANKING] Datos encontrados en colección: costumers_Melissa_Escobar -> 0
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/ranking?limit=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[RANKING] Datos encontrados en colección: costumers_Evelin_Garcia -> 0
[RANKING] Parámetros recibidos: {
  fechaInicio: undefined,
  fechaFin: undefined,
  all: undefined,
  limitParam: '1',
  debug: undefined,
  skipDate: undefined,
  agente: undefined,
  field: 'createdAt'
}
[RANGOS] Efectivo { startDate: '2025-12-01', endDate: '2025-12-02' }
[RANKING] Pipeline de agregación: [
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$createdAt"
              },
              "date"
            ]
          },
          "$createdAt",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "string"
                ]
              },
              {
                "$dateFromString": {
                  "dateString": {
                    "$toString": "$createdAt"
                  },
                  "timezone": "-06:00"
                }
              },
              null
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$dia_venta"
              },
              "date"
            ]
          },
          "$dia_venta",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$dateFromString": {
                      "dateString": "$$s",
                      "format": "%Y-%m-%d",
                      "timezone": "-06:00"
                    }
                  },
                  {
                    "$cond": [
                      {
                        "$regexMatch": {
                          "input": "$$s",
                          "regex": {}
                        }
                      },
                      {
                        "$let": {
                          "vars": {
                            "parts": {
                              "$split": [
                                "$$s",
                                "/"
                              ]
                            }
                          },
                          "in": {
                            "$dateFromParts": {
                              "year": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    2
                                  ]
                                }
                              },
                              "month": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    1
                                  ]
                                }
                              },
                              "day": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    0
                                  ]
                                }
                              }
                            }
                          }
                        }
                      },
                      {
                        "$cond": [
                          {
                            "$regexMatch": {
                              "input": "$$s",
                              "regex": {}
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$let": {
                      "vars": {
                        "parts": {
                          "$split": [
                            "$$s",
                            "/"
                          ]
                        }
                      },
                      "in": {
                        "$dateFromParts": {
                          "year": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                2
                              ]
                            }
                          },
                          "month": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                1
                              ]
                            }
                          },
                          "day": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                0
                              ]
                            }
                          }
                        }
                      }
                    }
                  },
                  null
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "date"
                ]
              },
              "$createdAt",
              {
                "$cond": [
                  {
                    "$eq": [
                      {
                        "$type": "$createdAt"
                      },
                      "string"
                    ]
                  },
                  {
                    "$dateFromString": {
                      "dateString": {
                        "$toString": "$createdAt"
                      },
                      "timezone": "-06:00"
                    }
                  },
                  null
                ]
              }
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "_diaParsed": {
        "$ne": null
      },
      "$expr": {
        "$and": [
          {
            "$gte": [
              "$_diaParsed",
              "2025-12-01T06:00:00.000Z"
            ]
          },
          {
            "$lt": [
              "$_diaParsed",
              "2026-01-01T06:00:00.000Z"
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$regex": {}
          }
        },
        {
          "agente": {
            "$regex": {}
          }
        }
      ]
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$exists": true,
            "$ne": ""
          }
        },
        {
          "agente": {
            "$exists": true,
            "$ne": ""
          }
        }
      ],
      "excluirDeReporte": {
        "$ne": true
      }
    }
  },
  {
    "$addFields": {
      "_statusStr": {
        "$toUpper": {
          "$trim": {
            "input": {
              "$ifNull": [
                "$status",
                ""
              ]
            }
          }
        }
      },
      "_agenteFuente": {
        "$ifNull": [
          "$agenteNombre",
          "$agente"
        ]
      }
    }
  },
  {
    "$addFields": {
      "_statusNorm": {
        "$cond": [
          {
            "$regexMatch": {
              "input": "$_statusStr",
              "regex": {}
            }
          },
          "CANCEL",
          {
            "$cond": [
              {
                "$regexMatch": {
                  "input": "$_statusStr",
                  "regex": {}
                }
              },
              "PENDING",
              "$_statusStr"
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "isCancel": {
        "$eq": [
          "$_statusNorm",
          "CANCEL"
        ]
      },
      "puntajeEfectivo": {
        "$cond": [
          {
            "$eq": [
              "$_statusNorm",
              "CANCEL"
            ]
          },
          0,
          {
            "$toDouble": {
              "$ifNull": [
                "$puntaje",
                0
              ]
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_nameNoSpaces": {
        "$replaceAll": {
          "input": {
            "$replaceAll": {
              "input": {
                "$replaceAll": {
                  "input": "$_agenteFuente",
                  "find": "_",
                  "replacement": ""
                }
              },
              "find": ".",
              "replacement": ""
            }
          },
          "find": " ",
          "replacement": ""
        }
      },
      "_nameNormLower": {
        "$toLower": {
          "$replaceAll": {
            "input": {
              "$replaceAll": {
                "input": {
                  "$replaceAll": {
                    "input": "$_agenteFuente",
                    "find": "_",
                    "replacement": ""
                  }
                },
                "find": ".",
                "replacement": ""
              }
            },
            "find": " ",
            "replacement": ""
          }
        }
      }
    }
  },
  {
    "$group": {
      "_id": "$_nameNormLower",
      "ventas": {
        "$sum": {
          "$cond": [
            "$isCancel",
            0,
            1
          ]
        }
      },
      "sumPuntaje": {
        "$sum": "$puntajeEfectivo"
      },
      "avgPuntaje": {
        "$avg": "$puntaje"
      },
      "anyName": {
        "$first": "$_nameNoSpaces"
      }
    }
  },
  {
    "$project": {
      "_id": 0,
      "nombre": "$anyName",
      "ventas": 1,
      "sumPuntaje": "$sumPuntaje",
      "avgPuntaje": "$avgPuntaje",
      "puntos": "$sumPuntaje"
    }
  },
  {
    "$sort": {
      "puntos": -1,
      "ventas": -1,
      "nombre": 1
    }
  },
  {
    "$limit": 1
  }
]
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro automático por mes actual: 2025-12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[RANKING] Datos encontrados en colección: costumers_Fabricio_Panameo -> 0
[RANKING] Colecciones candidatas para ALL: [
  'costumers_Fernanda_Castillo',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez'
]
[RANKING] Datos encontrados en colección: costumers_Daniela_Bonilla -> 0
[RANKING] Datos encontrados en colección: costumers_Fernanda_Castillo -> 0
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-12-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 18
[RANKING] Datos encontrados en colección: costumers_Roxana_Martinez -> 0
[RANKING] Datos encontrados en colección: costumers_Jonathan_Morales -> 0
[RANKING] Datos encontrados en colección: costumers_Josue_Renderos -> 0
[RANKING] Datos encontrados en colección: costumers_Lucia_Ferman -> 0
[RANKING] Datos encontrados en colección: costumers_Diego_Mejia -> 0
[RANKING] Datos encontrados en colección: costumers_Carlos_Grande -> 0
[RANKING] Datos encontrados en colección: costumers_Eduardo_R -> 0
[RANKING] Datos encontrados en colección: costumers_68ba19 -> 0
[RANKING] Datos encontrados en colección: costumers_Nelson_Ceren -> 0
[RANKING] Datos encontrados en colección: costumers_Francisco_Aguilar -> 0
[API /leads] Integrando TEAM_LINEAS en mapa. Colecciones: [
  'JONATHAN_F',
  'FERNANDO_BELTRAN',
  'EDWARD_RAMIREZ',
  'NANCY_LOPEZ',
  'VICTOR_HURTADO',
  'KARLA_RODRIGUEZ',
  'DANIEL_DEL_CID',
  'JONATHAN_GARCIA',
  'CRISTIAN_RIVERA',
  'JOCELYN_REYES',
  'LUIS_G'
]
[RANKING] Datos encontrados en colección: costumers_Luis_Chavarria -> 0
[RANKING] Datos encontrados en colección: costumers_68e6e788e878e212dc64e8c4 -> 0
[RANKING] Datos encontrados en colección: costumers_68af41d0c61c405e2bb7b0c8 -> 0
[RANKING] Datos encontrados en colección: costumers_Alexander_Rivera -> 0
[RANKING] Datos encontrados en colección: costumers_Anderson_Guzman -> 0
[RANKING] Datos encontrados en colección: costumers_Miguel_Nunez -> 0
[RANKING] Datos encontrados en colección: costumers_Melissa_Escobar -> 0
[RANKING] Datos encontrados en colección: costumers_Katerine_Gomez -> 0
[RANKING] Datos encontrados en colección: costumers_Evelin_Garcia -> 0
[RANKING] Datos encontrados en colección: costumers_Kimberly_Iglesias -> 0
[RANKING] Datos encontrados en colección: costumers_Fabricio_Panameo -> 0
[RANKING] Datos encontrados en colección: costumers_Abigail_Galdamez -> 0
[RANKING] Datos encontrados en colección: costumers_Daniela_Bonilla -> 0
[RANKING] Datos encontrados en colección: costumers_Tatiana_Ayala -> 0
[RANKING] Datos encontrados en colección: costumers_Roxana_Martinez -> 0
[RANKING] Datos encontrados en colección: costumers_Giselle_Diaz -> 0
[RANKING] Datos encontrados en colección: costumers_Josue_Renderos -> 0
[RANKING] Datos encontrados en colección: costumers_692371 -> 0
[RANKING] Datos encontrados en colección: costumers_Diego_Mejia -> 0
[RANKING] Datos encontrados en colección: costumers_692e09 -> 0
[RANKING] Datos encontrados en colección: costumers_Eduardo_R -> 0
[RANKING] Datos encontrados en colección: costumers_Priscila_Hernandez -> 0
[API /leads] Solicitud GLOBAL sin filtros (mapa u otros). Total combinado: 1497
[RANKING] Datos encontrados en colección: costumers_Francisco_Aguilar -> 0
[RANKING] Datos encontrados en colección: costumers_Steven_Varela -> 0
[RANKING] Datos encontrados en colección: costumers_68e6e788e878e212dc64e8c4 -> 0
[RANKING] Datos encontrados en colección: costumers_Riquelmi_Torres -> 0
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?allData=true&noFilter=true&skipDate=true&limit=1&page=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[RANKING] Datos encontrados en colección: costumers_Alexander_Rivera -> 0
[RANKING] Datos encontrados en colección: costumers -> 1
[USERS UPDATE ROLE] after getDb, db present? true
[RANKING] Datos encontrados en colección: costumers_Miguel_Nunez -> 0
[RANKING] Datos encontrados en colección: costumers_Johanna_Santana -> 0
[RANKING] Datos encontrados en colección: costumers_Katerine_Gomez -> 0
[RANKING] Datos encontrados en colección: costumers_Cindy_Flores -> 0
[RANKING] Datos encontrados en colección: costumers_Kimberly_Iglesias -> 0
[RANKING] Datos encontrados en colección: costumers_Lisbeth_Cortez -> 1
[RANKING] Datos encontrados en colección: costumers_Abigail_Galdamez -> 0
[RANKING] Datos encontrados en colección: costumers_Alejandra_Melara -> 0
[RANKING] Datos encontrados en colección: costumers_Tatiana_Ayala -> 0
[RANKING] Datos encontrados en colección: costumers_Julio_Chavez -> 0
[RANKING] Resultados de la consulta: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2
  }
]
[RANKING] Valores exactos de puntajes:
1. LisbethCortez: sumPuntaje=2.2 (tipo: number), avgPuntaje=0.55 (tipo: number), puntos=2.2 (tipo: number)
[RANKING] Devolviendo datos: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2,
    promedio: 0.55,
    position: 1
  }
]
[RANKING] Datos finales enviados al frontend:
1. LisbethCortez: puntos=2.2, sumPuntaje=2.2, avgPuntaje=0.55, promedio=0.55
[RANKING] Datos encontrados en colección: costumers_Giselle_Diaz -> 0
[RANKING] Datos encontrados en colección: costumers_692371 -> 0
[RANKING] Datos encontrados en colección: costumers_692e09 -> 0
[RANKING] Datos encontrados en colección: costumers_Priscila_Hernandez -> 0
[RANKING] Datos encontrados en colección: costumers_Steven_Varela -> 0
[RANKING] Datos encontrados en colección: costumers_Riquelmi_Torres -> 0
[RANKING] Datos encontrados en colección: costumers -> 1
[RANKING] Datos encontrados en colección: costumers_Johanna_Santana -> 0
[RANKING] Datos encontrados en colección: costumers_Cindy_Flores -> 0
[RANKING] Datos encontrados en colección: costumers_Lisbeth_Cortez -> 1
[RANKING] Datos encontrados en colección: costumers_Alejandra_Melara -> 0
[Socket.io] Nueva conexión: L_trqeO4SKq_Pg8dAAAB
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?page=1&limit=50000&skipDate=1&showAllMonths=1&fechaInicio=2025-01-01&fechaFin=2025-12-31&allData=1&noDateFilter=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"'
  }
}
[Socket.io] Usuario registrado: Lisbeth Cortez
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[RANKING] Datos encontrados en colección: costumers_Julio_Chavez -> 0
[RANKING] Resultados de la consulta: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2
  }
]
[RANKING] Valores exactos de puntajes:
1. LisbethCortez: sumPuntaje=2.2 (tipo: number), avgPuntaje=0.55 (tipo: number), puntos=2.2 (tipo: number)
[RANKING] Devolviendo datos: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2,
    promedio: 0.55,
    position: 1
  }
]
[RANKING] Datos finales enviados al frontend:
1. LisbethCortez: puntos=2.2, sumPuntaje=2.2, avgPuntaje=0.55, promedio=0.55
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro de fecha: 2025-01-01 a 2025-12-31
[API /leads] Strings de fecha buscados: [ '2025-01-01', '01/01/2025', '2025-01-02', '02/01/2025' ]
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[API /leads] Integrando TEAM_LINEAS en mapa. Colecciones: [
  'JONATHAN_F',
  'FERNANDO_BELTRAN',
  'EDWARD_RAMIREZ',
  'NANCY_LOPEZ',
  'VICTOR_HURTADO',
  'KARLA_RODRIGUEZ',
  'DANIEL_DEL_CID',
  'JONATHAN_GARCIA',
  'CRISTIAN_RIVERA',
  'JOCELYN_REYES',
  'LUIS_G'
]
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?month=12&year=2025',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro por mes específico: 12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": []
          }
        },
        {
          "createdAt": {
            "$gte": null,
            "$lte": null
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 0
[API /leads] Solicitud GLOBAL sin filtros (mapa u otros). Total combinado: 1497
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": [
              "2025-01-01",
              "01/01/2025",
              "2025-01-02",
              "02/01/2025",
              "2025-01-03",
              "03/01/2025",
              "2025-01-04",
              "04/01/2025",
              "2025-01-05",
              "05/01/2025",
              "2025-01-06",
              "06/01/2025",
              "2025-01-07",
              "07/01/2025",
              "2025-01-08",
              "08/01/2025",
              "2025-01-09",
              "09/01/2025",
              "2025-01-10",
              "10/01/2025",
              "2025-01-11",
              "11/01/2025",
              "2025-01-12",
              "12/01/2025",
              "2025-01-13",
              "13/01/2025",
              "2025-01-14",
              "14/01/2025",
              "2025-01-15",
              "15/01/2025",
              "2025-01-16",
              "16/01/2025",
              "2025-01-17",
              "17/01/2025",
              "2025-01-18",
              "18/01/2025",
              "2025-01-19",
              "19/01/2025",
              "2025-01-20",
              "20/01/2025",
              "2025-01-21",
              "21/01/2025",
              "2025-01-22",
              "22/01/2025",
              "2025-01-23",
              "23/01/2025",
              "2025-01-24",
              "24/01/2025",
              "2025-01-25",
              "25/01/2025",
              "2025-01-26",
              "26/01/2025",
              "2025-01-27",
              "27/01/2025",
              "2025-01-28",
              "28/01/2025",
              "2025-01-29",
              "29/01/2025",
              "2025-01-30",
              "30/01/2025",
              "2025-01-31",
              "31/01/2025",
              "2025-02-01",
              "01/02/2025",
              "2025-02-02",
              "02/02/2025",
              "2025-02-03",
              "03/02/2025",
              "2025-02-04",
              "04/02/2025",
              "2025-02-05",
              "05/02/2025",
              "2025-02-06",
              "06/02/2025",
              "2025-02-07",
              "07/02/2025",
              "2025-02-08",
              "08/02/2025",
              "2025-02-09",
              "09/02/2025",
              "2025-02-10",
              "10/02/2025",
              "2025-02-11",
              "11/02/2025",
              "2025-02-12",
              "12/02/2025",
              "2025-02-13",
              "13/02/2025",
              "2025-02-14",
              "14/02/2025",
              "2025-02-15",
              "15/02/2025",
              "2025-02-16",
              "16/02/2025",
              "2025-02-17",
              "17/02/2025",
              "2025-02-18",
              "18/02/2025",
              "2025-02-19",
              "19/02/2025",
              "2025-02-20",
              "20/02/2025",
              "2025-02-21",
              "21/02/2025",
              "2025-02-22",
              "22/02/2025",
              "2025-02-23",
              "23/02/2025",
              "2025-02-24",
              "24/02/2025",
              "2025-02-25",
              "25/02/2025",
              "2025-02-26",
              "26/02/2025",
              "2025-02-27",
              "27/02/2025",
              "2025-02-28",
              "28/02/2025",
              "2025-03-01",
              "01/03/2025",
              "2025-03-02",
              "02/03/2025",
              "2025-03-03",
              "03/03/2025",
              "2025-03-04",
              "04/03/2025",
              "2025-03-05",
              "05/03/2025",
              "2025-03-06",
              "06/03/2025",
              "2025-03-07",
              "07/03/2025",
              "2025-03-08",
              "08/03/2025",
              "2025-03-09",
              "09/03/2025",
              "2025-03-10",
              "10/03/2025",
              "2025-03-11",
              "11/03/2025",
              "2025-03-12",
              "12/03/2025",
              "2025-03-13",
              "13/03/2025",
              "2025-03-14",
              "14/03/2025",
              "2025-03-15",
              "15/03/2025",
              "2025-03-16",
              "16/03/2025",
              "2025-03-17",
              "17/03/2025",
              "2025-03-18",
              "18/03/2025",
              "2025-03-19",
              "19/03/2025",
              "2025-03-20",
              "20/03/2025",
              "2025-03-21",
              "21/03/2025",
              "2025-03-22",
              "22/03/2025",
              "2025-03-23",
              "23/03/2025",
              "2025-03-24",
              "24/03/2025",
              "2025-03-25",
              "25/03/2025",
              "2025-03-26",
              "26/03/2025",
              "2025-03-27",
              "27/03/2025",
              "2025-03-28",
              "28/03/2025",
              "2025-03-29",
              "29/03/2025",
              "2025-03-30",
              "30/03/2025",
              "2025-03-31",
              "31/03/2025",
              "2025-04-01",
              "01/04/2025",
              "2025-04-02",
              "02/04/2025",
              "2025-04-03",
              "03/04/2025",
              "2025-04-04",
              "04/04/2025",
              "2025-04-05",
              "05/04/2025",
              "2025-04-06",
              "06/04/2025",
              "2025-04-07",
              "07/04/2025",
              "2025-04-08",
              "08/04/2025",
              "2025-04-09",
              "09/04/2025",
              "2025-04-10",
              "10/04/2025",
              "2025-04-11",
              "11/04/2025",
              "2025-04-12",
              "12/04/2025",
              "2025-04-13",
              "13/04/2025",
              "2025-04-14",
              "14/04/2025",
              "2025-04-15",
              "15/04/2025",
              "2025-04-16",
              "16/04/2025",
              "2025-04-17",
              "17/04/2025",
              "2025-04-18",
              "18/04/2025",
              "2025-04-19",
              "19/04/2025",
              "2025-04-20",
              "20/04/2025",
              "2025-04-21",
              "21/04/2025",
              "2025-04-22",
              "22/04/2025",
              "2025-04-23",
              "23/04/2025",
              "2025-04-24",
              "24/04/2025",
              "2025-04-25",
              "25/04/2025",
              "2025-04-26",
              "26/04/2025",
              "2025-04-27",
              "27/04/2025",
              "2025-04-28",
              "28/04/2025",
              "2025-04-29",
              "29/04/2025",
              "2025-04-30",
              "30/04/2025",
              "2025-05-01",
              "01/05/2025",
              "2025-05-02",
              "02/05/2025",
              "2025-05-03",
              "03/05/2025",
              "2025-05-04",
              "04/05/2025",
              "2025-05-05",
              "05/05/2025",
              "2025-05-06",
              "06/05/2025",
              "2025-05-07",
              "07/05/2025",
              "2025-05-08",
              "08/05/2025",
              "2025-05-09",
              "09/05/2025",
              "2025-05-10",
              "10/05/2025",
              "2025-05-11",
              "11/05/2025",
              "2025-05-12",
              "12/05/2025",
              "2025-05-13",
              "13/05/2025",
              "2025-05-14",
              "14/05/2025",
              "2025-05-15",
              "15/05/2025",
              "2025-05-16",
              "16/05/2025",
              "2025-05-17",
              "17/05/2025",
              "2025-05-18",
              "18/05/2025",
              "2025-05-19",
              "19/05/2025",
              "2025-05-20",
              "20/05/2025",
              "2025-05-21",
              "21/05/2025",
              "2025-05-22",
              "22/05/2025",
              "2025-05-23",
              "23/05/2025",
              "2025-05-24",
              "24/05/2025",
              "2025-05-25",
              "25/05/2025",
              "2025-05-26",
              "26/05/2025",
              "2025-05-27",
              "27/05/2025",
              "2025-05-28",
              "28/05/2025",
              "2025-05-29",
              "29/05/2025",
              "2025-05-30",
              "30/05/2025",
              "2025-05-31",
              "31/05/2025",
              "2025-06-01",
              "01/06/2025",
              "2025-06-02",
              "02/06/2025",
              "2025-06-03",
              "03/06/2025",
              "2025-06-04",
              "04/06/2025",
              "2025-06-05",
              "05/06/2025",
              "2025-06-06",
              "06/06/2025",
              "2025-06-07",
              "07/06/2025",
              "2025-06-08",
              "08/06/2025",
              "2025-06-09",
              "09/06/2025",
              "2025-06-10",
              "10/06/2025",
              "2025-06-11",
              "11/06/2025",
              "2025-06-12",
              "12/06/2025",
              "2025-06-13",
              "13/06/2025",
              "2025-06-14",
              "14/06/2025",
              "2025-06-15",
              "15/06/2025",
              "2025-06-16",
              "16/06/2025",
              "2025-06-17",
              "17/06/2025",
              "2025-06-18",
              "18/06/2025",
              "2025-06-19",
              "19/06/2025",
              "2025-06-20",
              "20/06/2025",
              "2025-06-21",
              "21/06/2025",
              "2025-06-22",
              "22/06/2025",
              "2025-06-23",
              "23/06/2025",
              "2025-06-24",
              "24/06/2025",
              "2025-06-25",
              "25/06/2025",
              "2025-06-26",
              "26/06/2025",
              "2025-06-27",
              "27/06/2025",
              "2025-06-28",
              "28/06/2025",
              "2025-06-29",
              "29/06/2025",
              "2025-06-30",
              "30/06/2025",
              "2025-07-01",
              "01/07/2025",
              "2025-07-02",
              "02/07/2025",
              "2025-07-03",
              "03/07/2025",
              "2025-07-04",
              "04/07/2025",
              "2025-07-05",
              "05/07/2025",
              "2025-07-06",
              "06/07/2025",
              "2025-07-07",
              "07/07/2025",
              "2025-07-08",
              "08/07/2025",
              "2025-07-09",
              "09/07/2025",
              "2025-07-10",
              "10/07/2025",
              "2025-07-11",
              "11/07/2025",
              "2025-07-12",
              "12/07/2025",
              "2025-07-13",
              "13/07/2025",
              "2025-07-14",
              "14/07/2025",
              "2025-07-15",
              "15/07/2025",
              "2025-07-16",
              "16/07/2025",
              "2025-07-17",
              "17/07/2025",
              "2025-07-18",
              "18/07/2025",
              "2025-07-19",
              "19/07/2025",
              "2025-07-20",
              "20/07/2025",
              "2025-07-21",
              "21/07/2025",
              "2025-07-22",
              "22/07/2025",
              "2025-07-23",
              "23/07/2025",
              "2025-07-24",
              "24/07/2025",
              "2025-07-25",
              "25/07/2025",
              "2025-07-26",
              "26/07/2025",
              "2025-07-27",
              "27/07/2025",
              "2025-07-28",
              "28/07/2025",
              "2025-07-29",
              "29/07/2025",
              "2025-07-30",
              "30/07/2025",
              "2025-07-31",
              "31/07/2025",
              "2025-08-01",
              "01/08/2025",
              "2025-08-02",
              "02/08/2025",
              "2025-08-03",
              "03/08/2025",
              "2025-08-04",
              "04/08/2025",
              "2025-08-05",
              "05/08/2025",
              "2025-08-06",
              "06/08/2025",
              "2025-08-07",
              "07/08/2025",
              "2025-08-08",
              "08/08/2025",
              "2025-08-09",
              "09/08/2025",
              "2025-08-10",
              "10/08/2025",
              "2025-08-11",
              "11/08/2025",
              "2025-08-12",
              "12/08/2025",
              "2025-08-13",
              "13/08/2025",
              "2025-08-14",
              "14/08/2025",
              "2025-08-15",
              "15/08/2025",
              "2025-08-16",
              "16/08/2025",
              "2025-08-17",
              "17/08/2025",
              "2025-08-18",
              "18/08/2025",
              "2025-08-19",
              "19/08/2025",
              "2025-08-20",
              "20/08/2025",
              "2025-08-21",
              "21/08/2025",
              "2025-08-22",
              "22/08/2025",
              "2025-08-23",
              "23/08/2025",
              "2025-08-24",
              "24/08/2025",
              "2025-08-25",
              "25/08/2025",
              "2025-08-26",
              "26/08/2025",
              "2025-08-27",
              "27/08/2025",
              "2025-08-28",
              "28/08/2025",
              "2025-08-29",
              "29/08/2025",
              "2025-08-30",
              "30/08/2025",
              "2025-08-31",
              "31/08/2025",
              "2025-09-01",
              "01/09/2025",
              "2025-09-02",
              "02/09/2025",
              "2025-09-03",
              "03/09/2025",
              "2025-09-04",
              "04/09/2025",
              "2025-09-05",
              "05/09/2025",
              "2025-09-06",
              "06/09/2025",
              "2025-09-07",
              "07/09/2025",
              "2025-09-08",
              "08/09/2025",
              "2025-09-09",
              "09/09/2025",
              "2025-09-10",
              "10/09/2025",
              "2025-09-11",
              "11/09/2025",
              "2025-09-12",
              "12/09/2025",
              "2025-09-13",
              "13/09/2025",
              "2025-09-14",
              "14/09/2025",
              "2025-09-15",
              "15/09/2025",
              "2025-09-16",
              "16/09/2025",
              "2025-09-17",
              "17/09/2025",
              "2025-09-18",
              "18/09/2025",
              "2025-09-19",
              "19/09/2025",
              "2025-09-20",
              "20/09/2025",
              "2025-09-21",
              "21/09/2025",
              "2025-09-22",
              "22/09/2025",
              "2025-09-23",
              "23/09/2025",
              "2025-09-24",
              "24/09/2025",
              "2025-09-25",
              "25/09/2025",
              "2025-09-26",
              "26/09/2025",
              "2025-09-27",
              "27/09/2025",
              "2025-09-28",
              "28/09/2025",
              "2025-09-29",
              "29/09/2025",
              "2025-09-30",
              "30/09/2025",
              "2025-10-01",
              "01/10/2025",
              "2025-10-02",
              "02/10/2025",
              "2025-10-03",
              "03/10/2025",
              "2025-10-04",
              "04/10/2025",
              "2025-10-05",
              "05/10/2025",
              "2025-10-06",
              "06/10/2025",
              "2025-10-07",
              "07/10/2025",
              "2025-10-08",
              "08/10/2025",
              "2025-10-09",
              "09/10/2025",
              "2025-10-10",
              "10/10/2025",
              "2025-10-11",
              "11/10/2025",
              "2025-10-12",
              "12/10/2025",
              "2025-10-13",
              "13/10/2025",
              "2025-10-14",
              "14/10/2025",
              "2025-10-15",
              "15/10/2025",
              "2025-10-16",
              "16/10/2025",
              "2025-10-17",
              "17/10/2025",
              "2025-10-18",
              "18/10/2025",
              "2025-10-19",
              "19/10/2025",
              "2025-10-20",
              "20/10/2025",
              "2025-10-21",
              "21/10/2025",
              "2025-10-22",
              "22/10/2025",
              "2025-10-23",
              "23/10/2025",
              "2025-10-24",
              "24/10/2025",
              "2025-10-25",
              "25/10/2025",
              "2025-10-26",
              "26/10/2025",
              "2025-10-27",
              "27/10/2025",
              "2025-10-28",
              "28/10/2025",
              "2025-10-29",
              "29/10/2025",
              "2025-10-30",
              "30/10/2025",
              "2025-10-31",
              "31/10/2025",
              "2025-11-01",
              "01/11/2025",
              "2025-11-02",
              "02/11/2025",
              "2025-11-03",
              "03/11/2025",
              "2025-11-04",
              "04/11/2025",
              "2025-11-05",
              "05/11/2025",
              "2025-11-06",
              "06/11/2025",
              "2025-11-07",
              "07/11/2025",
              "2025-11-08",
              "08/11/2025",
              "2025-11-09",
              "09/11/2025",
              "2025-11-10",
              "10/11/2025",
              "2025-11-11",
              "11/11/2025",
              "2025-11-12",
              "12/11/2025",
              "2025-11-13",
              "13/11/2025",
              "2025-11-14",
              "14/11/2025",
              "2025-11-15",
              "15/11/2025",
              "2025-11-16",
              "16/11/2025",
              "2025-11-17",
              "17/11/2025",
              "2025-11-18",
              "18/11/2025",
              "2025-11-19",
              "19/11/2025",
              "2025-11-20",
              "20/11/2025",
              "2025-11-21",
              "21/11/2025",
              "2025-11-22",
              "22/11/2025",
              "2025-11-23",
              "23/11/2025",
              "2025-11-24",
              "24/11/2025",
              "2025-11-25",
              "25/11/2025",
              "2025-11-26",
              "26/11/2025",
              "2025-11-27",
              "27/11/2025",
              "2025-11-28",
              "28/11/2025",
              "2025-11-29",
              "29/11/2025",
              "2025-11-30",
              "30/11/2025",
              "2025-12-01",
              "01/12/2025",
              "2025-12-02",
              "02/12/2025",
              "2025-12-03",
              "03/12/2025",
              "2025-12-04",
              "04/12/2025",
              "2025-12-05",
              "05/12/2025",
              "2025-12-06",
              "06/12/2025",
              "2025-12-07",
              "07/12/2025",
              "2025-12-08",
              "08/12/2025",
              "2025-12-09",
              "09/12/2025",
              "2025-12-10",
              "10/12/2025",
              "2025-12-11",
              "11/12/2025",
              "2025-12-12",
              "12/12/2025",
              "2025-12-13",
              "13/12/2025",
              "2025-12-14",
              "14/12/2025",
              "2025-12-15",
              "15/12/2025",
              "2025-12-16",
              "16/12/2025",
              "2025-12-17",
              "17/12/2025",
              "2025-12-18",
              "18/12/2025",
              "2025-12-19",
              "19/12/2025",
              "2025-12-20",
              "20/12/2025",
              "2025-12-21",
              "21/12/2025",
              "2025-12-22",
              "22/12/2025",
              "2025-12-23",
              "23/12/2025",
              "2025-12-24",
              "24/12/2025",
              "2025-12-25",
              "25/12/2025",
              "2025-12-26",
              "26/12/2025",
              "2025-12-27",
              "27/12/2025",
              "2025-12-28",
              "28/12/2025",
              "2025-12-29",
              "29/12/2025",
              "2025-12-30",
              "30/12/2025",
              "2025-12-31",
              "31/12/2025"
            ]
          }
        },
        {
          "createdAt": {
            "$gte": "2025-01-01T06:00:00.000Z",
            "$lte": "2026-01-01T05:59:59.999Z"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jan 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jan 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jan 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jan 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jan 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jan 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jan 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jan 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jan 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jan 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jan 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jan 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jan 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jan 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jan 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jan 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jan 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jan 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jan 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jan 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jan 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jan 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jan 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jan 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jan 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jan 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jan 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jan 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jan 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jan 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jan 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Feb 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Feb 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Feb 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Feb 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Feb 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Feb 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Feb 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Feb 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Feb 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Feb 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Feb 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Feb 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Feb 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Feb 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Feb 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Feb 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Feb 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Feb 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Feb 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Feb 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Feb 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Feb 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Feb 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Feb 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Feb 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Feb 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Feb 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Feb 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Mar 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Mar 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Mar 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Mar 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Mar 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Mar 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Mar 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Mar 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Mar 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Mar 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Mar 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Mar 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Mar 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Mar 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Mar 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Mar 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Mar 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Mar 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Mar 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Mar 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Mar 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Mar 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Mar 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Mar 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Mar 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Mar 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Mar 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Mar 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Mar 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Mar 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Mar 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Apr 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Apr 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Apr 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Apr 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Apr 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Apr 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Apr 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Apr 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Apr 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Apr 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Apr 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Apr 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Apr 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Apr 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Apr 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Apr 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Apr 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Apr 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Apr 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Apr 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Apr 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Apr 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Apr 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Apr 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Apr 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Apr 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Apr 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Apr 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Apr 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Apr 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu May 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri May 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat May 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun May 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon May 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue May 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed May 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu May 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri May 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat May 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun May 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon May 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue May 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed May 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu May 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri May 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat May 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun May 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon May 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue May 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed May 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu May 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri May 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat May 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun May 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon May 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue May 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed May 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu May 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri May 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat May 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jun 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jun 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jun 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jun 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jun 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jun 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jun 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jun 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jun 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jun 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jun 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jun 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jun 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jun 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jun 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jun 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jun 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jun 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jun 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jun 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jun 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jun 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jun 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jun 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jun 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jun 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jun 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jun 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jun 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jun 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jul 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jul 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jul 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jul 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jul 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jul 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jul 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jul 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jul 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jul 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jul 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jul 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jul 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jul 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jul 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jul 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jul 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jul 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jul 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jul 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jul 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jul 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jul 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jul 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Jul 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Jul 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Jul 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Jul 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Jul 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Jul 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Jul 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Aug 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Aug 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Aug 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Aug 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Aug 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Aug 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Aug 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Aug 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Aug 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Aug 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Aug 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Aug 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Aug 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Aug 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Aug 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Aug 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Aug 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Aug 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Aug 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Aug 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Aug 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Aug 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Aug 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Aug 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Aug 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Aug 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Aug 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Aug 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Aug 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Aug 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Aug 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Sep 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Sep 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Sep 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Sep 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Sep 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Sep 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Sep 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Sep 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Sep 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Sep 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Sep 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Sep 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Sep 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Sep 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Sep 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Sep 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Sep 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Sep 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Sep 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Sep 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Sep 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Sep 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Sep 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Sep 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Sep 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Sep 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Sep 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Sep 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Sep 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Sep 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Oct 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Oct 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Oct 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Oct 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Oct 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Oct 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Oct 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Oct 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Oct 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Oct 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Oct 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Oct 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Oct 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Oct 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Oct 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Oct 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Oct 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Oct 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Oct 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Oct 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Oct 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Oct 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Oct 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Oct 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Oct 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Oct 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Oct 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Oct 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Oct 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Oct 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Oct 31 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Nov 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Nov 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Nov 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Nov 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Nov 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Nov 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Nov 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Nov 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Nov 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Nov 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Nov 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Nov 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Nov 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Nov 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Nov 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Nov 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Nov 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Nov 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Nov 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Nov 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Nov 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Nov 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Nov 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Nov 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Nov 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Nov 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Nov 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Nov 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Nov 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Nov 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 01 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 02 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 03 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 04 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 05 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 06 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 07 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 08 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 09 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 10 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 11 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 12 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 13 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 14 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 15 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 16 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 17 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 18 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 19 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 20 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 21 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 22 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 23 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 24 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Thu Dec 25 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Fri Dec 26 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sat Dec 27 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Sun Dec 28 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Mon Dec 29 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Tue Dec 30 2025",
            "$options": "i"
          }
        },
        {
          "dia_venta": {
            "$regex": "^Wed Dec 31 2025",
            "$options": "i"
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 1435
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/customers?page=1&limit=50000&skipDate=1&showAllMonths=1&fechaInicio=2025-01-01&fechaFin=2025-12-31&allData=1&noDateFilter=1',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
Solicitud recibida en /api/customers
Parámetros - Página: 1, Límite: 500, Saltar: 0
Colecciones disponibles en crmagente: [
  'employeesOfMonth',
  'noteFiles.chunks',
  'costumers_Fernanda_Castillo',
  'Facturacion',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'bulk_status_audit',
  'employees_of_month',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'employeeofmonths',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'leads',
  'user_collections',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'CostumersExcluidos',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'users',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'noteFiles.files',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'mediafiles',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez',
  'Lineas',
  'Vcomments'
]
Intentando acceder a la colección (default): costumers
[INFO] Using mapped collection for current user: costumers_Lisbeth_Cortez
[DEBUG] Usuario autenticado - ID: 68af5651c61c405e2bb7b0e6, Rol: "Agente", Rol original: "Agente", forceAll=false
[DEBUG] ¿Es supervisor? role === 'supervisor': false, includes: false
[DEBUG] Rol no privilegiado: aplicando filtro propio por ID en campos: [
  'agenteId',   'agente_id',
  'idAgente',   'agentId',
  'createdBy',  'creadoPor',
  'creado_por', 'ownerId',
  'assignedId'
]
[DEBUG] Filtro aplicado: {
  "$or": [
    {
      "agenteId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "agente_id": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "idAgente": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "agentId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "createdBy": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "creadoPor": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "creado_por": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "ownerId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    },
    {
      "assignedId": {
        "$in": [
          "68af5651c61c405e2bb7b0e6",
          "68af5651c61c405e2bb7b0e6"
        ]
      }
    }
  ]
}
[DEBUG] req.query recibido en /api/customers: {"page":"1","limit":"50000","skipDate":"1","showAllMonths":"1","fechaInicio":"2025-01-01","fechaFin":"2025-12-31","allData":"1","noDateFilter":"1"}
[DEBUG] Query final a usar en MongoDB: {"$or":[{"agenteId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"agente_id":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"idAgente":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"agentId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"createdBy":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"creadoPor":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"creado_por":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"ownerId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}},{"assignedId":{"$in":["68af5651c61c405e2bb7b0e6","68af5651c61c405e2bb7b0e6"]}}],"creadoEn":{"$gte":"2025-01-01T00:00:00.000Z","$lte":"2025-12-31T05:59:59.999Z"}}
Total de documentos en la colección: 44
[DEBUG] Orden aplicándose: { creadoEn: -1 }
Documentos encontrados: 44
Primer documento de ejemplo: {
  "_id": "692f250915275dfe49d5521d",
  "nombre_cliente": "MAUDA  HERNANDEZ",
  "telefono": "6319189849",
  "telefono_alterno": "",
  "direccion": "85 N Mickley Ave Indianapolis IN 46224",
  "tipo_servicio": "XFINITY",
  "producto": "",
  "servicios": "xfinity-500-plus",
  "servicios_texto": "XFINITY 500MBPS+",
  "sistema": "na",
  "sistema_texto": "N/A",
  "mercado": "ICON",
  "riesgo": "N/A",
  "autopago": true,
  "dia_venta": "2025-12-02",
  "team": "ROBERTO",
  "supervisor": "ROBERTO",
  "agente": "Lisbeth Cortez",
  "dia_instalacion": "2025-12-04",
  "puntaje": 0.75,
  "zip": "46224",
  "creadoEn": "2025-12-02T17:42:33.232Z",
  "actualizadoEn": "2025-12-02T17:42:33.232Z",
  "producto_contratado": "XFINITY 500MBPS+",
  "fecha_contratacion": "2025-12-02",
  "equipo": "ROBERTO",
  "fecha_creacion": "2025-12-02T17:42:33.232Z",
  "status": "pendiente",
  "comentario": "ADQUIRIR SERVICIOS",
  "motivo_llamada": "ADQUIRIR SERVICIOS",
  "numero_cuenta": "2512024239687129",
  "telefono_principal": "6319189849",
  "fuente": "WEB",
  "asignadoA": null,
  "notas": [],
  "agenteNombre": "Lisbeth Cortez",
  "agenteId": "68af5651c61c405e2bb7b0e6",
  "createdBy": "Lisbeth Cortez",
  "historial": [
    {
      "accion": "CREADO",
      "fecha": "2025-12-02T17:42:33.232Z",
      "usuario": "Lisbeth Cortez",
      "detalles": "Lead creado a través del formulario web",
      "agenteId": "68af5651c61c405e2bb7b0e6"
    }
  ]
}
Enviando respuesta con 44 clientes
[Socket.io] Desconectado: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: undefined
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/media?category=marketing&limit=1&sort=desc&orderBy=uploadDate&t=1764717666619',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[MEDIA] Solicitud a /api/media recibida
[MEDIA] Ejecutando consulta a mediafiles con orden: {"uploadDate":-1}
[MEDIA] Encontrados 1 archivos en BD
[MEDIA] ✓ Archivo Cloudinary: 20251109_055145.jpg
[MEDIA] Devolviendo 1 archivos válidos
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/auth/verify-server',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[VERIFY-SERVER] Verificando autenticación...
[VERIFY-SERVER] Cookies: {
  token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE'
}
[VERIFY-SERVER] Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE
[VERIFY-SERVER] Token válido para usuario: Lisbeth Cortez
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/leads?month=12&year=2025',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4YWY1NjUxYzYxYzQwNWUyYmI3YjBlNiIsInVzZXJuYW1lIjoiTGlzYmV0aCBDb3J0ZXoiLCJyb2xlIjoiQWdlbnRlIiwiaWF0IjoxNzY0NzE3MzU1LCJleHAiOjE3NjUzMjIxNTV9.FRiGb5Sg3RsbKFpVj2alVWCyCX837ilkWzp2SIWCtxE',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    accept: 'application/json'
  }
}
[AUTH] Token desde Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/ranking?fechaInicio=2025-12-01&fechaFin=2025-12-02&t=1764717667160',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[USERS UPDATE ROLE] after getDb, db present? true
[API /leads] Filtro por mes específico: 12
[API /leads] Usuario: Lisbeth Cortez, Rol: agente
[RANKING] Parámetros recibidos: {
  fechaInicio: '2025-12-01',
  fechaFin: '2025-12-02',
  all: undefined,
  limitParam: undefined,
  debug: undefined,
  skipDate: undefined,
  agente: undefined,
  field: 'createdAt'
}
[RANGOS] Efectivo { startDate: '2025-12-01', endDate: '2025-12-02' }
[RANKING] Pipeline de agregación: [
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$createdAt"
              },
              "date"
            ]
          },
          "$createdAt",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "string"
                ]
              },
              {
                "$dateFromString": {
                  "dateString": {
                    "$toString": "$createdAt"
                  },
                  "timezone": "-06:00"
                }
              },
              null
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$dia_venta"
              },
              "date"
            ]
          },
          "$dia_venta",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$dateFromString": {
                      "dateString": "$$s",
                      "format": "%Y-%m-%d",
                      "timezone": "-06:00"
                    }
                  },
                  {
                    "$cond": [
                      {
                        "$regexMatch": {
                          "input": "$$s",
                          "regex": {}
                        }
                      },
                      {
                        "$let": {
                          "vars": {
                            "parts": {
                              "$split": [
                                "$$s",
                                "/"
                              ]
                            }
                          },
                          "in": {
                            "$dateFromParts": {
                              "year": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    2
                                  ]
                                }
                              },
                              "month": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    1
                                  ]
                                }
                              },
                              "day": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    0
                                  ]
                                }
                              }
                            }
                          }
                        }
                      },
                      {
                        "$cond": [
                          {
                            "$regexMatch": {
                              "input": "$$s",
                              "regex": {}
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$let": {
                      "vars": {
                        "parts": {
                          "$split": [
                            "$$s",
                            "/"
                          ]
                        }
                      },
                      "in": {
                        "$dateFromParts": {
                          "year": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                2
                              ]
                            }
                          },
                          "month": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                1
                              ]
                            }
                          },
                          "day": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                0
                              ]
                            }
                          }
                        }
                      }
                    }
                  },
                  null
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "date"
                ]
              },
              "$createdAt",
              {
                "$cond": [
                  {
                    "$eq": [
                      {
                        "$type": "$createdAt"
                      },
                      "string"
                    ]
                  },
                  {
                    "$dateFromString": {
                      "dateString": {
                        "$toString": "$createdAt"
                      },
                      "timezone": "-06:00"
                    }
                  },
                  null
                ]
              }
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "_diaParsed": {
        "$ne": null
      },
      "$expr": {
        "$and": [
          {
            "$gte": [
              "$_diaParsed",
              "2025-12-01T06:00:00.000Z"
            ]
          },
          {
            "$lt": [
              "$_diaParsed",
              "2026-01-01T06:00:00.000Z"
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$regex": {}
          }
        },
        {
          "agente": {
            "$regex": {}
          }
        }
      ]
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$exists": true,
            "$ne": ""
          }
        },
        {
          "agente": {
            "$exists": true,
            "$ne": ""
          }
        }
      ],
      "excluirDeReporte": {
        "$ne": true
      }
    }
  },
  {
    "$addFields": {
      "_statusStr": {
        "$toUpper": {
          "$trim": {
            "input": {
              "$ifNull": [
                "$status",
                ""
              ]
            }
          }
        }
      },
      "_agenteFuente": {
        "$ifNull": [
          "$agenteNombre",
          "$agente"
        ]
      }
    }
  },
  {
    "$addFields": {
      "_statusNorm": {
        "$cond": [
          {
            "$regexMatch": {
              "input": "$_statusStr",
              "regex": {}
            }
          },
          "CANCEL",
          {
            "$cond": [
              {
                "$regexMatch": {
                  "input": "$_statusStr",
                  "regex": {}
                }
              },
              "PENDING",
              "$_statusStr"
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "isCancel": {
        "$eq": [
          "$_statusNorm",
          "CANCEL"
        ]
      },
      "puntajeEfectivo": {
        "$cond": [
          {
            "$eq": [
              "$_statusNorm",
              "CANCEL"
            ]
          },
          0,
          {
            "$toDouble": {
              "$ifNull": [
                "$puntaje",
                0
              ]
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_nameNoSpaces": {
        "$replaceAll": {
          "input": {
            "$replaceAll": {
              "input": {
                "$replaceAll": {
                  "input": "$_agenteFuente",
                  "find": "_",
                  "replacement": ""
                }
              },
              "find": ".",
              "replacement": ""
            }
          },
          "find": " ",
          "replacement": ""
        }
      },
      "_nameNormLower": {
        "$toLower": {
          "$replaceAll": {
            "input": {
              "$replaceAll": {
                "input": {
                  "$replaceAll": {
                    "input": "$_agenteFuente",
                    "find": "_",
                    "replacement": ""
                  }
                },
                "find": ".",
                "replacement": ""
              }
            },
            "find": " ",
            "replacement": ""
          }
        }
      }
    }
  },
  {
    "$group": {
      "_id": "$_nameNormLower",
      "ventas": {
        "$sum": {
          "$cond": [
            "$isCancel",
            0,
            1
          ]
        }
      },
      "sumPuntaje": {
        "$sum": "$puntajeEfectivo"
      },
      "avgPuntaje": {
        "$avg": "$puntaje"
      },
      "anyName": {
        "$first": "$_nameNoSpaces"
      }
    }
  },
  {
    "$project": {
      "_id": 0,
      "nombre": "$anyName",
      "ventas": 1,
      "sumPuntaje": "$sumPuntaje",
      "avgPuntaje": "$avgPuntaje",
      "puntos": "$sumPuntaje"
    }
  },
  {
    "$sort": {
      "puntos": -1,
      "ventas": -1,
      "nombre": 1
    }
  },
  {
    "$limit": 500
  }
]
[API /leads] Query ejecutado: {
  "$and": [
    {
      "$or": [
        {
          "dia_venta": {
            "$in": []
          }
        },
        {
          "createdAt": {
            "$gte": null,
            "$lte": null
          }
        }
      ]
    }
  ]
}
[API /leads] Resultados encontrados: 0
[RANKING] Colecciones candidatas para ALL: [
  'costumers_Fernanda_Castillo',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez'
]
[RANKING] Datos encontrados en colección: costumers_Fernanda_Castillo -> 0
[RANKING] Datos encontrados en colección: costumers_Jonathan_Morales -> 0
[RANKING] Datos encontrados en colección: costumers_Lucia_Ferman -> 0
[RANKING] Datos encontrados en colección: costumers_Carlos_Grande -> 0
[RANKING] Datos encontrados en colección: costumers_68ba19 -> 0
[RANKING] Datos encontrados en colección: costumers_Nelson_Ceren -> 0
[RANKING] Datos encontrados en colección: costumers_Luis_Chavarria -> 0
[RANKING] Datos encontrados en colección: costumers_68af41d0c61c405e2bb7b0c8 -> 0
[RANKING] Datos encontrados en colección: costumers_Anderson_Guzman -> 0
[RANKING] Datos encontrados en colección: costumers_Melissa_Escobar -> 0
[RANKING] Datos encontrados en colección: costumers_Evelin_Garcia -> 0
[RANKING] Datos encontrados en colección: costumers_Fabricio_Panameo -> 0
[RANKING] Datos encontrados en colección: costumers_Daniela_Bonilla -> 0
[RANKING] Datos encontrados en colección: costumers_Roxana_Martinez -> 0
[RANKING] Datos encontrados en colección: costumers_Josue_Renderos -> 0
[RANKING] Datos encontrados en colección: costumers_Diego_Mejia -> 0
[RANKING] Datos encontrados en colección: costumers_Eduardo_R -> 0
[RANKING] Datos encontrados en colección: costumers_Francisco_Aguilar -> 0
[RANKING] Datos encontrados en colección: costumers_68e6e788e878e212dc64e8c4 -> 0
[RANKING] Datos encontrados en colección: costumers_Alexander_Rivera -> 0
[RANKING] Datos encontrados en colección: costumers_Miguel_Nunez -> 0
[RANKING] Datos encontrados en colección: costumers_Katerine_Gomez -> 0
[RANKING] Datos encontrados en colección: costumers_Kimberly_Iglesias -> 0
[RANKING] Datos encontrados en colección: costumers_Abigail_Galdamez -> 0
[RANKING] Datos encontrados en colección: costumers_Tatiana_Ayala -> 0
[RANKING] Datos encontrados en colección: costumers_Giselle_Diaz -> 0
[RANKING] Datos encontrados en colección: costumers_692371 -> 0
[RANKING] Datos encontrados en colección: costumers_692e09 -> 0
[RANKING] Datos encontrados en colección: costumers_Priscila_Hernandez -> 0
[RANKING] Datos encontrados en colección: costumers_Steven_Varela -> 0
[RANKING] Datos encontrados en colección: costumers_Riquelmi_Torres -> 0
[RANKING] Datos encontrados en colección: costumers -> 1
[RANKING] Datos encontrados en colección: costumers_Johanna_Santana -> 0
[RANKING] Datos encontrados en colección: costumers_Cindy_Flores -> 0
[RANKING] Datos encontrados en colección: costumers_Lisbeth_Cortez -> 1
[RANKING] Datos encontrados en colección: costumers_Alejandra_Melara -> 0
[RANKING] Datos encontrados en colección: costumers_Julio_Chavez -> 0
[RANKING] Resultados de la consulta: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2
  }
]
[RANKING] Valores exactos de puntajes:
1. LisbethCortez: sumPuntaje=2.2 (tipo: number), avgPuntaje=0.55 (tipo: number), puntos=2.2 (tipo: number)
[RANKING] Devolviendo datos: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2,
    promedio: 0.55,
    position: 1
  }
]
[RANKING] Datos finales enviados al frontend:
1. LisbethCortez: puntos=2.2, sumPuntaje=2.2, avgPuntaje=0.55, promedio=0.55
[API DEBUG] Incoming request {
  method: 'GET',
  url: '/api/ranking?fechaInicio=2025-12-01&fechaFin=2025-12-02&all=1&t=1764717669473',
  headersPreview: {
    host: 'localhost:3000',
    connection: 'keep-alive',
    'sec-ch-ua-platform': '"Windows"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0',
    'sec-ch-ua': '"Chromium";v="142", "Microsoft Edge";v="142", "Not_A Brand";v="99"',
    'sec-ch-ua-mobile': '?0'
  }
}
[AUTH] Token desde cookies: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[RANKING] Parámetros recibidos: {
  fechaInicio: '2025-12-01',
  fechaFin: '2025-12-02',
  all: '1',
  limitParam: undefined,
  debug: undefined,
  skipDate: undefined,
  agente: undefined,
  field: 'createdAt'
}
[RANGOS] Efectivo { startDate: '2025-12-01', endDate: '2025-12-02' }
[RANKING] Pipeline de agregación: [
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$createdAt"
              },
              "date"
            ]
          },
          "$createdAt",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "string"
                ]
              },
              {
                "$dateFromString": {
                  "dateString": {
                    "$toString": "$createdAt"
                  },
                  "timezone": "-06:00"
                }
              },
              null
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$eq": [
              {
                "$type": "$dia_venta"
              },
              "date"
            ]
          },
          "$dia_venta",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$dateFromString": {
                      "dateString": "$$s",
                      "format": "%Y-%m-%d",
                      "timezone": "-06:00"
                    }
                  },
                  {
                    "$cond": [
                      {
                        "$regexMatch": {
                          "input": "$$s",
                          "regex": {}
                        }
                      },
                      {
                        "$let": {
                          "vars": {
                            "parts": {
                              "$split": [
                                "$$s",
                                "/"
                              ]
                            }
                          },
                          "in": {
                            "$dateFromParts": {
                              "year": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    2
                                  ]
                                }
                              },
                              "month": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    1
                                  ]
                                }
                              },
                              "day": {
                                "$toInt": {
                                  "$arrayElemAt": [
                                    "$$parts",
                                    0
                                  ]
                                }
                              }
                            }
                          }
                        }
                      },
                      {
                        "$cond": [
                          {
                            "$regexMatch": {
                              "input": "$$s",
                              "regex": {}
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          },
                          {
                            "$dateFromString": {
                              "dateString": "$$s",
                              "timezone": "-06:00"
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$let": {
              "vars": {
                "s": {
                  "$toString": "$dia_venta"
                }
              },
              "in": {
                "$cond": [
                  {
                    "$regexMatch": {
                      "input": "$$s",
                      "regex": {}
                    }
                  },
                  {
                    "$let": {
                      "vars": {
                        "parts": {
                          "$split": [
                            "$$s",
                            "/"
                          ]
                        }
                      },
                      "in": {
                        "$dateFromParts": {
                          "year": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                2
                              ]
                            }
                          },
                          "month": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                1
                              ]
                            }
                          },
                          "day": {
                            "$toInt": {
                              "$arrayElemAt": [
                                "$$parts",
                                0
                              ]
                            }
                          }
                        }
                      }
                    }
                  },
                  null
                ]
              }
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_diaParsed": {
        "$cond": [
          {
            "$ne": [
              "$_diaParsed",
              null
            ]
          },
          "$_diaParsed",
          {
            "$cond": [
              {
                "$eq": [
                  {
                    "$type": "$createdAt"
                  },
                  "date"
                ]
              },
              "$createdAt",
              {
                "$cond": [
                  {
                    "$eq": [
                      {
                        "$type": "$createdAt"
                      },
                      "string"
                    ]
                  },
                  {
                    "$dateFromString": {
                      "dateString": {
                        "$toString": "$createdAt"
                      },
                      "timezone": "-06:00"
                    }
                  },
                  null
                ]
              }
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "_diaParsed": {
        "$ne": null
      },
      "$expr": {
        "$and": [
          {
            "$gte": [
              "$_diaParsed",
              "2025-12-01T06:00:00.000Z"
            ]
          },
          {
            "$lt": [
              "$_diaParsed",
              "2026-01-01T06:00:00.000Z"
            ]
          }
        ]
      }
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$regex": {}
          }
        },
        {
          "agente": {
            "$regex": {}
          }
        }
      ]
    }
  },
  {
    "$match": {
      "$or": [
        {
          "agenteNombre": {
            "$exists": true,
            "$ne": ""
          }
        },
        {
          "agente": {
            "$exists": true,
            "$ne": ""
          }
        }
      ],
      "excluirDeReporte": {
        "$ne": true
      }
    }
  },
  {
    "$addFields": {
      "_statusStr": {
        "$toUpper": {
          "$trim": {
            "input": {
              "$ifNull": [
                "$status",
                ""
              ]
            }
          }
        }
      },
      "_agenteFuente": {
        "$ifNull": [
          "$agenteNombre",
          "$agente"
        ]
      }
    }
  },
  {
    "$addFields": {
      "_statusNorm": {
        "$cond": [
          {
            "$regexMatch": {
              "input": "$_statusStr",
              "regex": {}
            }
          },
          "CANCEL",
          {
            "$cond": [
              {
                "$regexMatch": {
                  "input": "$_statusStr",
                  "regex": {}
                }
              },
              "PENDING",
              "$_statusStr"
            ]
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "isCancel": {
        "$eq": [
          "$_statusNorm",
          "CANCEL"
        ]
      },
      "puntajeEfectivo": {
        "$cond": [
          {
            "$eq": [
              "$_statusNorm",
              "CANCEL"
            ]
          },
          0,
          {
            "$toDouble": {
              "$ifNull": [
                "$puntaje",
                0
              ]
            }
          }
        ]
      }
    }
  },
  {
    "$addFields": {
      "_nameNoSpaces": {
        "$replaceAll": {
          "input": {
            "$replaceAll": {
              "input": {
                "$replaceAll": {
                  "input": "$_agenteFuente",
                  "find": "_",
                  "replacement": ""
                }
              },
              "find": ".",
              "replacement": ""
            }
          },
          "find": " ",
          "replacement": ""
        }
      },
      "_nameNormLower": {
        "$toLower": {
          "$replaceAll": {
            "input": {
              "$replaceAll": {
                "input": {
                  "$replaceAll": {
                    "input": "$_agenteFuente",
                    "find": "_",
                    "replacement": ""
                  }
                },
                "find": ".",
                "replacement": ""
              }
            },
            "find": " ",
            "replacement": ""
          }
        }
      }
    }
  },
  {
    "$group": {
      "_id": "$_nameNormLower",
      "ventas": {
        "$sum": {
          "$cond": [
            "$isCancel",
            0,
            1
          ]
        }
      },
      "sumPuntaje": {
        "$sum": "$puntajeEfectivo"
      },
      "avgPuntaje": {
        "$avg": "$puntaje"
      },
      "anyName": {
        "$first": "$_nameNoSpaces"
      }
    }
  },
  {
    "$project": {
      "_id": 0,
      "nombre": "$anyName",
      "ventas": 1,
      "sumPuntaje": "$sumPuntaje",
      "avgPuntaje": "$avgPuntaje",
      "puntos": "$sumPuntaje"
    }
  },
  {
    "$sort": {
      "puntos": -1,
      "ventas": -1,
      "nombre": 1
    }
  },
  {
    "$limit": 500
  }
]
[RANKING] Colecciones candidatas para ALL: [
  'costumers_Fernanda_Castillo',
  'costumers_Jonathan_Morales',
  'costumers_Lucia_Ferman',
  'costumers_Carlos_Grande',
  'costumers_68ba19',
  'costumers_Nelson_Ceren',
  'costumers_Luis_Chavarria',
  'costumers_68af41d0c61c405e2bb7b0c8',
  'costumers_Anderson_Guzman',
  'costumers_Melissa_Escobar',
  'costumers_Evelin_Garcia',
  'costumers_Fabricio_Panameo',
  'costumers_Daniela_Bonilla',
  'costumers_Roxana_Martinez',
  'costumers_Josue_Renderos',
  'costumers_Diego_Mejia',
  'costumers_Eduardo_R',
  'costumers_Francisco_Aguilar',
  'costumers_68e6e788e878e212dc64e8c4',
  'costumers_Alexander_Rivera',
  'costumers_Miguel_Nunez',
  'costumers_Katerine_Gomez',
  'costumers_Kimberly_Iglesias',
  'costumers_Abigail_Galdamez',
  'costumers_Tatiana_Ayala',
  'costumers_Giselle_Diaz',
  'costumers_692371',
  'costumers_692e09',
  'costumers_Priscila_Hernandez',
  'costumers_Steven_Varela',
  'costumers_Riquelmi_Torres',
  'costumers',
  'costumers_Johanna_Santana',
  'costumers_Cindy_Flores',
  'costumers_Lisbeth_Cortez',
  'costumers_Alejandra_Melara',
  'costumers_Julio_Chavez'
]
[RANKING] Datos encontrados en colección: costumers_Fernanda_Castillo -> 0
[RANKING] Datos encontrados en colección: costumers_Jonathan_Morales -> 0
[RANKING] Datos encontrados en colección: costumers_Lucia_Ferman -> 0
[RANKING] Datos encontrados en colección: costumers_Carlos_Grande -> 0
[RANKING] Datos encontrados en colección: costumers_68ba19 -> 0
[RANKING] Datos encontrados en colección: costumers_Nelson_Ceren -> 0
[RANKING] Datos encontrados en colección: costumers_Luis_Chavarria -> 0
[RANKING] Datos encontrados en colección: costumers_68af41d0c61c405e2bb7b0c8 -> 0
[RANKING] Datos encontrados en colección: costumers_Anderson_Guzman -> 0
[RANKING] Datos encontrados en colección: costumers_Melissa_Escobar -> 0
[RANKING] Datos encontrados en colección: costumers_Evelin_Garcia -> 0
[RANKING] Datos encontrados en colección: costumers_Fabricio_Panameo -> 0
[RANKING] Datos encontrados en colección: costumers_Daniela_Bonilla -> 0
[RANKING] Datos encontrados en colección: costumers_Roxana_Martinez -> 0
[RANKING] Datos encontrados en colección: costumers_Josue_Renderos -> 0
[RANKING] Datos encontrados en colección: costumers_Diego_Mejia -> 0
[RANKING] Datos encontrados en colección: costumers_Eduardo_R -> 0
[RANKING] Datos encontrados en colección: costumers_Francisco_Aguilar -> 0
[RANKING] Datos encontrados en colección: costumers_68e6e788e878e212dc64e8c4 -> 0
[RANKING] Datos encontrados en colección: costumers_Alexander_Rivera -> 0
[RANKING] Datos encontrados en colección: costumers_Miguel_Nunez -> 0
[RANKING] Datos encontrados en colección: costumers_Katerine_Gomez -> 0
[RANKING] Datos encontrados en colección: costumers_Kimberly_Iglesias -> 0
[RANKING] Datos encontrados en colección: costumers_Abigail_Galdamez -> 0
[RANKING] Datos encontrados en colección: costumers_Tatiana_Ayala -> 0
[RANKING] Datos encontrados en colección: costumers_Giselle_Diaz -> 0
[RANKING] Datos encontrados en colección: costumers_692371 -> 0
[RANKING] Datos encontrados en colección: costumers_692e09 -> 0
[RANKING] Datos encontrados en colección: costumers_Priscila_Hernandez -> 0
[RANKING] Datos encontrados en colección: costumers_Steven_Varela -> 0
[RANKING] Datos encontrados en colección: costumers_Riquelmi_Torres -> 0
[RANKING] Datos encontrados en colección: costumers -> 1
[RANKING] Datos encontrados en colección: costumers_Johanna_Santana -> 0
[RANKING] Datos encontrados en colección: costumers_Cindy_Flores -> 0
[RANKING] Datos encontrados en colección: costumers_Lisbeth_Cortez -> 1
[RANKING] Datos encontrados en colección: costumers_Alejandra_Melara -> 0
[RANKING] Datos encontrados en colección: costumers_Julio_Chavez -> 0
[RANKING] Resultados de la consulta: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2
  }
]
[RANKING] Valores exactos de puntajes:
1. LisbethCortez: sumPuntaje=2.2 (tipo: number), avgPuntaje=0.55 (tipo: number), puntos=2.2 (tipo: number)
[RANKING] Devolviendo datos: [
  {
    _id: 'lisbethcortez',
    nombre: 'LisbethCortez',
    ventas: 4,
    sumPuntaje: 2.2,
    avgPuntaje: 0.55,
    puntos: 2.2,
    promedio: 0.55,
    position: 1
  }
]
[RANKING] Datos finales enviados al frontend:
1. LisbethCortez: puntos=2.2, sumPuntaje=2.2, avgPuntaje=0.55, promedio=0.55
